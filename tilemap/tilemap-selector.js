!async function(e){var t=e.defineMessages,e=e.gui.Component;const i=t({MenuButton:{id:"tilemap.menuButton",default:"Menu"},UntitledName:{id:"tilemap.untitledName",default:"Untitled"}});class M extends e{static get observedState(){return[]}constructor(){super(),this.state={menuVisible:!1}}stateChangedCallback(e,t,i){t!==i&&"menuVisible"===e&&(this.dropdownMenu.style.display=i?"block":"none")}getUniqueName(e){e=e||this.galleryList.childElementCount;var t=""+i.UntitledName+e;return this.querySelector(`.tile-map-list-image[name="${t}"]`)?this.getUniqueName(e+1):t}updateMenu(e){var t;this.menuContent.innerHTML="",e.forEach(e=>{var t=document.createElement("div");t.addEventListener("click",this.handleMenuItemClick.bind(this)),t.className="tile-map-dropdown-content-item",this.state.galleryId===e.value&&t.classList.add("actived"),t.dataset.id=e.value,t.innerHTML='<div class="checkbox"></div>'+e.text,this.menuContent.appendChild(t)}),this.querySelector(".tile-map-dropdown-content-item.actived")||(t=this.menuContent.firstElementChild)&&(t.classList.add("actived"),this.setState({galleryId:t.dataset.id,galleryName:"",imageData:null})),e.length<3&&((t=this.querySelector(".tile-map-dropdown-wrapper"))&&(t.style.transform=`translate(60px, ${50-9*e.length}px)`),t=this.querySelector(".tile-map-dropdown-arrow"))&&(t.style.transform=`translate(-9px, ${9*e.length}px) rotate(-45deg)`)}updateGallery(e){var t;e&&(t=this.galleryList.lastElementChild,this.galleryList.innerHTML="",Object.entries(e).forEach(([e,t])=>{var i=document.createElement("div");i.className="tile-map-list-image",this.state.galleryName===e&&i.classList.add("actived"),i.dataset.name=e,i.style.backgroundImage=`url(${t.data})`,i.style.backgroundSize="contain",i.addEventListener("click",this.handleImageClick.bind(this)),this.galleryList.appendChild(i)}),this.galleryList.appendChild(t))}handleMenuClick(e){e.preventDefault(),e.stopPropagation(),this.dropdownMenu.click();const t=()=>{document.removeEventListener("click",t),this.setState("menuVisible",!1)};document.addEventListener("click",t),this.setState("menuVisible",!this.state.menuVisible)}handleMenuItemClick(e){e.preventDefault(),this.querySelectorAll(".tile-map-dropdown-content-item.actived").forEach(e=>{e.classList.remove("actived")});let t=e.target;(t="tile-map-dropdown-content-item"!==t.className?t.parentElement:t).classList.add("actived"),this.setState("galleryId",t.dataset.id)}removeImageActived(){this.querySelectorAll(".tile-map-list-image.actived").forEach(e=>{e.classList.remove("actived")})}newImage(){this.removeImageActived();var e=document.createElement("div");e.addEventListener("click",this.handleImageClick),e.className="tile-map-list-image",e.dataset.name=this.getUniqueName(),this.galleryList.insertBefore(e,this.galleryList.lastElementChild),e.classList.add("actived"),this.setState("galleryName",e.dataset.name)}handleImageClick(e){e.preventDefault();e=e.target;e===this.galleryList.lastElementChild?this.emit("NewImage"):(this.removeImageActived(),e.classList.add("actived"),this.setState("galleryName",e.dataset.name))}deleteImage(){var e=this.querySelector(".tile-map-list-image.actived");e&&(e.removeEventListener("click",this.handleImageClick),e.classList.remove("actived"),this.galleryList.removeChild(e),this.setState({galleryName:"",imageData:null}))}render(){return`
                <div class="tile-map-selector-wrapper">
                    <div
                        class="tile-map-tools-wrapper tile-map-menu-wrapper"
                        style="display:grid"
                    >
                        <button
                            class="tile-map-tool-button"
                            onclick="this.handleMenuClick"
                        >
                            <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjg2MzgwMDQzNjA3IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE5NTQ0IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48cGF0aCBkPSJNMjM2Ljk4Mjg1NyAyOTIuNTcxNDI5bDE4NS41MjY4NTcgNzguNjY1MTQyYzU0LjEyNTcxNCAxOS40Mzc3MTQgMTI0LjgzNjU3MSAxOS40Mzc3MTQgMTc4Ljk4MDU3MiAwTDc4Ny4wMTcxNDMgMjkyLjU3MTQyOWwtMTg1LjUyNjg1Ny03OC42NjUxNDNjLTU0LjEyNTcxNC0xOS40Mzc3MTQtMTI0LjgzNjU3MS0xOS40Mzc3MTQtMTc4Ljk4MDU3MiAwTDIzNi45ODI4NTcgMjkyLjU3MTQyOXogbTE1OC43Mi0xNDYuNzQyODU4YzcxLjE0OTcxNC0yNi4xODUxNDMgMTYxLjQ0NDU3MS0yNi4xODUxNDMgMjMyLjU5NDI4NiAwbDI3Mi45MzI1NzEgMTE1LjczMDI4NmEzNi41NzE0MjkgMzYuNTcxNDI5IDAgMCAxIDAgNjIuMDI1MTQzTDYyOC4yOTcxNDMgNDM5LjMxNDI4NmMtNzEuMTQ5NzE0IDI2LjE4NTE0My0xNjEuNDQ0NTcxIDI2LjE4NTE0My0yMzIuNTk0Mjg2IDBMMTIyLjc3MDI4NiAzMjMuNTg0YTM2LjU3MTQyOSAzNi41NzE0MjkgMCAwIDEgMC02Mi4wMjUxNDNMMzk1LjcwMjg1NyAxNDUuODI4NTcxeiIgcC1pZD0iMTk1NDUiIGZpbGw9IiM1NzVFNzUiPjwvcGF0aD48cGF0aCBkPSJNNzQ4LjM3OTQyOSA0NTIuMDk2bDEyLjcwODU3MS03LjgwOGEzNi41NzE0MjkgMzYuNTcxNDI5IDAgMCAxIDM3LjE1NjU3MS0wLjY3NjU3MWwxMDcuMTU0Mjg2IDQyLjI5NDg1N2EzNi41NzE0MjkgMzYuNTcxNDI5IDAgMCAxIDAgNjIuMDI1MTQzbC0yNzIuOTUwODU3IDExNS43MzAyODVjLTcxLjE2OCAyNi4xODUxNDMtMTYxLjQ2Mjg1NyAyNi4xODUxNDMtMjMyLjU5NDI4NiAwTDEyNi45MDI4NTcgNTQ3LjkxMzE0M2EzNi41NzE0MjkgMzYuNTcxNDI5IDAgMCAxIDAtNjIuMDA2ODU3bDk1LjYzNDI4Ni00MS40OTAyODZhMzYuNTcxNDI5IDM2LjU3MTQyOSAwIDAgMSAzNy4xOTMxNDMtMC45MzI1NzFsMTUuNDUxNDI4IDguNTk0Mjg1YTI0LjIxMDI4NiAyNC4yMTAyODYgMCAwIDEgMS44Mjg1NzIgNDEuMTk3NzE1bC02MS43MTQyODYgMjMuNjQzNDI4IDIyMy4zMjM0MjkgODQuNzE3NzE0YzQ3LjQzMzE0MyAxMS4zNTU0MjkgMTA3LjYyOTcxNCAxMS4zNTU0MjkgMTU1LjA2Mjg1NyAwbDIyMy4zMDUxNDMtODQuNzE3NzE0LTY4Ljk5Mi0yNi4wMDIyODZhMjIuOTMwMjg2IDIyLjkzMDI4NiAwIDAgMSAwLjM2NTcxNC0zOC44MjA1NzF6IiBwLWlkPSIxOTU0NiIgZmlsbD0iIzU3NUU3NSI+PC9wYXRoPjxwYXRoIGQ9Ik03NDguMzc5NDI5IDY3MS41MjQ1NzFsMTIuNzA4NTcxLTcuODA4YTM2LjU3MTQyOSAzNi41NzE0MjkgMCAwIDEgMzcuMTU2NTcxLTAuNjc2NTcxbDEwNy4xNTQyODYgNDIuMjk0ODU3YTM2LjU3MTQyOSAzNi41NzE0MjkgMCAwIDEgMCA2Mi4wMjUxNDNsLTI3Mi45NTA4NTcgMTE1LjczMDI4NmMtNzEuMTY4IDI2LjE4NTE0My0xNjEuNDYyODU3IDI2LjE4NTE0My0yMzIuNTk0Mjg2IDBMMTI2LjkwMjg1NyA3NjcuMzQxNzE0YTM2LjU3MTQyOSAzNi41NzE0MjkgMCAwIDEgMC02Mi4wMDY4NTdsOTUuNjM0Mjg2LTQxLjQ5MDI4NmEzNi41NzE0MjkgMzYuNTcxNDI5IDAgMCAxIDM3LjE5MzE0My0wLjkzMjU3MWwxNS40NTE0MjggOC41OTQyODZhMjQuMjEwMjg2IDI0LjIxMDI4NiAwIDAgMSAxLjgyODU3MiA0MS4xOTc3MTRsLTYxLjcxNDI4NiAyMy42NDM0MjkgMjIzLjMyMzQyOSA4NC43MTc3MTRjNDcuNDMzMTQzIDExLjM1NTQyOSAxMDcuNjI5NzE0IDExLjM1NTQyOSAxNTUuMDYyODU3IDBsMjIzLjMwNTE0My04NC43MTc3MTQtNjguOTkyLTI2LjAwMjI4NmEyMi45MzAyODYgMjIuOTMwMjg2IDAgMCAxIDAuMzY1NzE0LTM4LjgyMDU3MnoiIHAtaWQ9IjE5NTQ3IiBmaWxsPSIjNTc1RTc1Ij48L3BhdGg+PC9zdmc+" alt="${i.MenuButton}" title="${i.MenuButton}" />
                        </button>
                    </div>
                    <div class="tile-map-list-wrapper">
                        <div
                            id="gallery-list"
                            class="tile-map-list"
                        >
                            <div
                                class="tile-map-list-image add"
                                onclick="this.handleImageClick"
                            >
                            </div>
                        </div>
                    </div>
                </div>
                <div
                    id="dropdown-menu"
                    class="tile-map-dropdown-wrapper"
                >
                    <div
                        id="menu-content"
                        class="tile-map-dropdown-content"
                    >
                    </div>
                    <div class="tile-map-dropdown-arrow"></div>
                </div>
            `}}customElements.define("tile-map-selector",M)}(Scratch);